# PPT生成機能 機能仕様書

**作成日**: 2025-12-08
**対象**: Phase 2 Week 7
**関連**: `requirements_phase2_ppt_generation.md`

---

## 画面設計

### 1. 教授プロファイル設定画面

**パス**: `/profile/design`

**レイアウト**:
```
┌──────────────────────────────────────┐
│ ナビゲーション                        │
├──────────────────────────────────────┤
│ 教授プロファイル > デザイン設定        │
├──────────────────────────────────────┤
│                                      │
│ デフォルトデザイン設定                │
│ このデザインがPPT生成時の標準です     │
│                                      │
│ 【配色テーマ】                        │
│ ○ プロフェッショナル                  │
│ ○ 温かい・親しみやすい                │
│ ● カスタム                            │
│   Primary: [#2C5F7C] 🎨             │
│   Secondary: [#FF6B6B] 🎨           │
│   Accent: [#F4A259] 🎨              │
│                                      │
│ 【レイアウト】                        │
│ ● シンプル・余白重視                  │
│ ○ リッチ・ビジュアル重視              │
│                                      │
│ [💾 保存]                             │
└──────────────────────────────────────┘
```

---

### 2. PPT内容生成画面（ステップ1）

**パス**: `/ppt/generate`

```
┌──────────────────────────────────────┐
│ PPT内容生成                           │
├──────────────────────────────────────┤
│ プロンプト入力:                       │
│ ┌────────────────────────────────────┐│
│ │ 夫人会で講演することになりました。  ││
│ │ 40代の女性の集まりで...            ││
│ │                                    ││
│ │ (3000文字まで)                     ││
│ └────────────────────────────────────┘│
│                                      │
│ 💡 ヒント:                            │
│ • 対象者、イベント、テーマ、時間配分  │
│                                      │
│ [📝 内容を生成]                       │
└──────────────────────────────────────┘
```

---

### 3. 生成中画面

```
┌──────────────────────────────────────┐
│ 🔄 PPT内容を生成中...                 │
├──────────────────────────────────────┤
│                                      │
│ ✅ 検索クエリを生成                   │
│ ✅ ナレッジベースを検索（20件）        │
│ 🔄 詳細内容を生成中...                │
│ ⏳ 完了まで約30秒                     │
│                                      │
│ ━━━━━━━━━━━━━━━━ 70%             │
└──────────────────────────────────────┘
```

---

### 4. 編集画面（ステップ2）

```
┌──────────────────────────────────────┐
│ [✏️ 編集] [👁️ プレビュー]             │
├──────────────────────────────────────┤
│ ┌────────────────────────────────────┐│
│ │ # 私らしく働く力                    ││
│ │ ## 副題                             ││
│ │ ---                                 ││
│ │ ## スライド1: オープニング           ││
│ │ ...                                 ││
│ └────────────────────────────────────┘│
│                                      │
│ 文字数: 3,245 / 30,000               │
│ スライド数: 17枚                      │
│                                      │
│ [🎨 PPTプロンプト生成]                 │
└──────────────────────────────────────┘
```

---

### 5. Gensparkプロンプト表示

```
┌──────────────────────────────────────┐
│ ✅ Genspark用プロンプト生成完了        │
├──────────────────────────────────────┤
│ ┌────────────────────────────────────┐│
│ │ # Presentation Generation          ││
│ │ ## Speaker Profile...              ││
│ │ (15,234文字)                        ││
│ └────────────────────────────────────┘│
│                                      │
│ [📋 プロンプトをコピー]                │
│                                      │
│ 💡 次のステップ:                       │
│ 1. Gensparkにアクセス                 │
│ 2. プロンプトをペースト                │
│ 3. 生成実行                           │
└──────────────────────────────────────┘
```

---

### 6. 履歴一覧画面

```
┌──────────────────────────────────────┐
│ PPT生成履歴                           │
├──────────────────────────────────────┤
│ [+ 新規作成]                          │
├──────────────────────────────────────┤
│ 📊 2025-12-08                        │
│ 夫人会講演「私らしく働く力」          │
│ 17枚 | [表示] [削除]                 │
│                                      │
│ ※ 90日後に自動削除                   │
└──────────────────────────────────────┘
```

---

## API仕様

### POST /api/ppt/generate-content

**リクエスト**:
```json
{
  "prompt": "夫人会で講演...",
  "user_id": "uuid"
}
```

**レスポンス**:
```json
{
  "content_id": "uuid",
  "markdown_content": "# タイトル\n...",
  "slide_count": 17,
  "warnings": ["関連ナレッジが少ない"]
}
```

---

### POST /api/ppt/generate-genspark-prompt

**リクエスト**:
```json
{
  "content_id": "uuid",
  "edited_content": "編集後のMarkdown"
}
```

**レスポンス**:
```json
{
  "genspark_prompt": "# Presentation...",
  "length": 15234
}
```

---

### GET /api/ppt/history

**レスポンス**:
```json
{
  "items": [
    {
      "id": "uuid",
      "title": "夫人会講演",
      "slide_count": 17,
      "created_at": "2025-12-08"
    }
  ]
}
```

---

## 状態遷移

```
[入力画面]
    ↓ プロンプト入力
[生成中]
    ↓ 60秒
[編集画面]
    ↓ ユーザー編集
[プロンプト生成中]
    ↓ 10秒
[完成]
    → [履歴保存]
    → [コピー完了]
```

---

**作成者**: Claude
**レビュー**: 未
