# Phase 2: 教授思考学習型PPT自動生成システム 要件定義書

**最終更新**: 2025-11-24
**バージョン**: 1.0
**対象フェーズ**: Phase 2
**前提**: Phase 1 MVP完成済み

---

## 📋 改訂履歴

| バージョン | 日付 | 変更内容 | 作成者 |
|----------|------|---------|--------|
| 1.0 | 2025-11-24 | Phase 2要件定義書初版作成（壁打ちセッション結果反映） | Claude |

---

## 🎯 Phase 2の目的

### Phase 1からの進化

**Phase 1（レポートコメント自動生成）**:
- 入力：学生レポート
- 出力：コメント（Rubric採点、要約、コメント）
- 目的：教授のレポートコメント作成を効率化

**Phase 2（教授思考学習型PPT自動生成システム）**:
- **ナレッジベース**: 教授の思考を音声・テキストで継続的に学習
- **入力1**: 学生レポート → 出力：コメント（Phase 1機能継続、精度向上）
- **入力2**: ターゲット + 構成 + テーマ → **出力：PPT資料**（新機能）
- **目的**: 教授の思考を学習し、講義・講演資料の作成を自動化

### 核心的な価値提案

1. **継続的な学習**: 教授の講義、講演、独り言を音声・テキストで蓄積し、教授らしさを学習
2. **高精度なRAG**: Embeddingベースの検索で、関連する思考を正確に検索
3. **PPT資料自動生成**: ターゲット・構成・テーマを指定するだけで、教授らしいPPT資料を自動生成
4. **コメント精度向上**: ナレッジベースの充実により、レポートコメントの精度も自動的に向上

---

## 🏗️ Phase 2の全体構成

### 開発期間
**8週間**（Week 1-2: RAG強化 → Week 3-4: ナレッジベース管理 → Week 5-6: ファイルアップロード → Week 7: PPT生成 → Week 8: テスト）

### Phase 1との関係
- Phase 1の全機能を継承（レポートコメント生成）
- RAGの精度向上により、Phase 1の機能も改善
- Phase 1のナレッジベース（113件の参照例）を基盤として拡張

---

## 🎨 技術スタック（Phase 2）

### フロントエンド
- **フレームワーク**: Next.js 14 (App Router)（Phase 1と同じ）
- **言語**: TypeScript
- **スタイリング**: TailwindCSS
- **新規追加**: ファイルアップロード機能（ドラッグ&ドロップ対応）

### バックエンド
- **フレームワーク**: FastAPI（Phase 1と同じ）
- **言語**: Python 3.11+
- **LLM**:
  - コメント生成: gpt-4o-mini（Phase 1と同じ）
  - PPT資料生成: gpt-4o（高品質重視）
- **Embedding**: OpenAI text-embedding-3-small
- **音声認識**: Whisper API（OpenAI）
- **PPT生成**: python-pptx

### データベース
- **データベース**: Supabase (PostgreSQL)（Phase 1と同じ）
- **ベクトル検索**: pgvector拡張（新規追加）
- **認証**: Supabase Auth（Phase 1と同じ）

### 新規技術要素（Phase 2で追加）

| 技術 | 用途 | 選定理由 |
|------|------|---------|
| OpenAI Embeddings | テキストのベクトル化 | 高精度、低コスト（$0.02/1M tokens） |
| Supabase pgvector | ベクトル検索 | 既存Supabaseを活用、追加コストなし |
| Whisper API | 音声→テキスト変換 | 高精度、簡単な実装（$0.006/分） |
| python-pptx | PPTファイル生成 | Python標準的なライブラリ、豊富なドキュメント |
| gpt-4o | PPT内容生成 | 高品質な表現力（コメント生成より重要度が高い） |

---

## 📐 システムアーキテクチャ（Phase 2）

### データフロー（全体像）

```
【ナレッジベース構築フロー】
教授 → 音声/テキストファイルアップロード → Whisper API（音声の場合）
  → LLMによる自動タグ付け → 教授による確認・修正
  → Embedding化 → knowledge_baseテーブルに保存

【レポートコメント生成フロー】（Phase 1継承 + 精度向上）
学生レポート → PII検出・マスキング → Rubric採点 → 要約生成
  → Embedding化 → pgvectorで類似検索（上位3-5件）
  → LLM（gpt-4o-mini）でコメント生成 → 結果表示

【PPT資料生成フロー】（Phase 2新機能）
教授 → ターゲット + 構成 + テーマ を入力
  → Embedding化 → pgvectorで関連思考を検索
  → LLM（gpt-4o）でスライド内容生成（スライド毎）
  → python-pptxでPPTファイル生成 → ダウンロード
```

### データベース設計（Phase 2拡張）

#### 1. knowledge_base テーブル（Phase 2で拡張）

**Phase 1**:
```sql
CREATE TABLE knowledge_base (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  comment_text TEXT NOT NULL,
  report_type TEXT NOT NULL, -- "reflection" or "final"
  created_at TIMESTAMP NOT NULL DEFAULT NOW()
);
```

**Phase 2拡張**:
```sql
ALTER TABLE knowledge_base
  ADD COLUMN content_type TEXT NOT NULL DEFAULT 'comment',
    -- "comment", "lecture", "speech", "memo", "ppt_text"
  ADD COLUMN tags TEXT[] DEFAULT '{}',
    -- ["起業論", "戦略論", "リーダーシップ"] など
  ADD COLUMN source TEXT,
    -- "audio", "text", "ppt_import", "comment" など
  ADD COLUMN embedding VECTOR(1536);
    -- OpenAI text-embedding-3-small のベクトル（1536次元）

-- ベクトル検索用インデックス
CREATE INDEX ON knowledge_base USING ivfflat (embedding vector_cosine_ops);
```

#### 2. ppt_generations テーブル（新規追加）

```sql
CREATE TABLE ppt_generations (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID NOT NULL REFERENCES auth.users(id),
  target_audience TEXT NOT NULL,
    -- "学部1年生", "MBA", "企業経営者" など
  theme TEXT NOT NULL,
    -- "競争戦略の基礎" など
  structure JSONB NOT NULL,
    -- {"introduction": "5分", "theory": "15分", ...}
  slide_count INTEGER NOT NULL,
    -- 生成されたスライド枚数
  file_path TEXT,
    -- 生成されたPPTファイルのパス（オプション）
  satisfaction INTEGER,
    -- 満足度（1-5）
  created_at TIMESTAMP NOT NULL DEFAULT NOW()
);

-- RLS設定
CREATE POLICY "Users can only see their own ppt_generations"
ON ppt_generations FOR SELECT
USING (auth.uid() = user_id);
```

---

## 🎯 機能要件（Phase 2）

### 1. RAG精度向上（Week 1-2）

#### 1.1 Embedding導入
- OpenAI Embeddings API統合
- knowledge_baseテーブルにembeddingカラム追加
- 既存の113件の参照例をEmbedding化
- 新規追加時に自動でEmbedding化

#### 1.2 ベクトル検索実装
- pgvector拡張の有効化
- コサイン類似度検索の実装
- 検索結果の上位3-5件を取得（調整可能）

#### 1.3 検索精度の検証
- Jaccard類似度とEmbedding類似度の比較
- コメント生成精度の改善を測定

### 2. ナレッジベース管理UI（Week 3-4）

#### 2.1 ナレッジベース一覧画面

**レイアウト**:
```
[ナレッジベース管理]
┌─────────────────────────────────────┐
│ [新規追加（テキスト）] [音声入力]     │
├─────────────────────────────────────┤
│ 🔍 検索: [_______] タグ: [全て▼]     │
│ 並び順: [最新順▼] 件数: 113件         │
├─────────────────────────────────────┤
│ 📝 起業論, 顧客視点 | 2025-11-24      │
│ 「学生が起業を考えるとき、まず顧客視点...」│
│ ソース: 音声 | comment               │
│ [編集] [削除]                        │
├─────────────────────────────────────┤
│ 📝 戦略論 | 2025-11-20               │
│ 「競争優位の本質は、模倣困難性にあります...」│
│ ソース: テキスト | lecture            │
│ [編集] [削除]                        │
└─────────────────────────────────────┘
[ページネーション: 1 2 3 ... 10]
```

**機能**:
- 検索・フィルタ（テキスト検索、タグフィルタ）
- 並び替え（最新順、古い順、タグ別）
- 編集・削除機能
- ページネーション（20件/ページ）

#### 2.2 テキスト追加画面

**レイアウト**:
```
[新規追加（テキスト）]
┌─────────────────────────────────────┐
│ 内容:                                │
│ ┌─────────────────────────────────┐ │
│ │                                 │ │
│ │                                 │ │
│ │                                 │ │
│ └─────────────────────────────────┘ │
│ 文字数: 0                            │
│                                     │
│ コンテンツタイプ:                     │
│ ○ コメント例 ○ 講義内容              │
│ ○ 講演内容 ○ メモ ○ PPT資料         │
│                                     │
│ 提案タグ: [起業論] [顧客視点]         │
│ （AI自動提案、編集可能）              │
│ [タグ追加]                           │
│                                     │
│ [保存] [キャンセル]                  │
└─────────────────────────────────────┘
```

**機能**:
- テキスト入力（5000文字制限）
- コンテンツタイプ選択
- LLMによる自動タグ付け + 手動編集
- タグの追加・削除

#### 2.3 編集・削除機能
- 既存のナレッジベースを編集
- タグの変更
- 削除確認ダイアログ

### 3. ファイルアップロード機能（Week 5-6）

**要件変更**: 音声録音機能（MediaRecorder API）→ ファイルアップロード機能に変更

#### 3.1 ファイルアップロード画面

**レイアウト**:
```
[ファイルアップロード]
┌─────────────────────────────────────┐
│ 📁 ファイルをドラッグ&ドロップ        │
│    または                            │
│ [📎 ファイルを選択]                  │
│                                     │
│ 対応形式:                            │
│ • 音声: mp3, wav, m4a（最大25MB）    │
│ • テキスト: txt（最大1MB）           │
└─────────────────────────────────────┘

↓ ファイル選択後

┌─────────────────────────────────────┐
│ ✅ ファイル選択: lecture_20251124.mp3│
│ サイズ: 5.2MB                        │
│                                     │
│ [🚀 アップロード開始]                │
└─────────────────────────────────────┘

↓ アップロード中

┌─────────────────────────────────────┐
│ 🔄 アップロード中...                 │
│ ━━━━━━━━━━━━━━━ 60%               │
│                                     │
│ （音声ファイルの場合）                │
│ 🔄 テキスト変換中...                │
│ （Whisper APIで処理中）              │
└─────────────────────────────────────┘

↓ テキスト変換完了後

┌─────────────────────────────────────┐
│ テキスト変換結果:                     │
│ ┌─────────────────────────────────┐ │
│ │「学生が起業を考えるとき、まず顧客 │ │
│ │ 視点を持つことが重要です。顧客が │ │
│ │ 何を求めているのか...」          │ │
│ └─────────────────────────────────┘ │
│ [編集可能]                           │
│                                     │
│ コンテンツタイプ: [講義内容 ▼]       │
│                                     │
│ 提案タグ: [起業論] [顧客視点]         │
│ [タグ編集]                           │
│                                     │
│ [保存] [やり直し]                    │
└─────────────────────────────────────┘
```

**機能**:
- ドラッグ&ドロップまたはファイル選択でアップロード
- 対応形式: 音声（mp3, wav, m4a）、テキスト（txt）
- アップロード進捗表示
- Whisper APIでテキスト変換（音声ファイルの場合）
- 変換結果の編集
- LLMによる自動タグ付け + 手動編集

#### 3.2 バックエンドAPI（POST /upload-file）

**入力**:
- file: アップロードファイル（音声またはテキスト）
- user_id: 認証ユーザーID

**処理**:
1. ファイルタイプを判定
2. 音声ファイルの場合: Whisper APIでテキスト化
3. テキストファイルの場合: 内容を抽出
4. LLM（gpt-4o-mini）で自動タグ付け
5. 提案タグを返却

**出力**:
- text: テキスト化された内容（音声）またはファイル内容（テキスト）
- suggested_tags: 提案タグ（配列）
- file_type: "audio" または "text"

### 4. PPT資料自動生成機能（Week 7）

#### 4.1 PPT生成入力画面

**レイアウト**:
```
[PPT資料生成]
┌─────────────────────────────────────┐
│ ターゲット:                          │
│ ○ 学部1年生 ○ 学部2年生              │
│ ○ MBA ○ 企業経営者 ○ 学会            │
│ ○ その他 [__________]               │
│                                     │
│ テーマ:                              │
│ [競争戦略の基礎___________________] │
│                                     │
│ 構成（選択式）:                      │
│ ☑ 導入（5分）                       │
│ ☑ 理論解説（15分）                  │
│ ☑ 事例紹介（15分）                  │
│ ☑ ディスカッション（10分）          │
│ ☑ まとめ（5分）                     │
│                                     │
│ 予想スライド枚数: 約10枚              │
│                                     │
│ [生成開始]                           │
└─────────────────────────────────────┘

↓ 生成中

┌─────────────────────────────────────┐
│ 🔄 PPT資料を生成中...                │
│                                     │
│ ✅ ナレッジベース検索完了             │
│ ✅ スライド1: タイトル生成完了        │
│ ✅ スライド2: 導入生成完了            │
│ 🔄 スライド3: 理論解説生成中...       │
│ ⏳ スライド4-10: 待機中               │
│                                     │
│ 進捗: 30%                            │
└─────────────────────────────────────┘

↓ 生成完了

┌─────────────────────────────────────┐
│ ✅ PPT資料生成完了！                 │
│                                     │
│ ファイル名: 競争戦略の基礎_20251124.pptx │
│ スライド枚数: 10枚                   │
│                                     │
│ [📥 ダウンロード]                    │
│                                     │
│ 満足度を教えてください:               │
│ ⭐⭐⭐⭐⭐ (1-5)                    │
│                                     │
│ [フィードバック送信]                 │
└─────────────────────────────────────┘
```

#### 4.2 バックエンドAPI（POST /generate-ppt）

**入力**:
- target_audience: ターゲット（"学部2年生" など）
- theme: テーマ（"競争戦略の基礎" など）
- structure: 構成（配列: ["導入", "理論解説", "事例紹介", ...]）
- user_id: 認証ユーザーID

**処理フロー**:
1. テーマをEmbedding化
2. pgvectorで関連するナレッジベースを検索（上位10-20件）
3. 各セクション毎にLLM（gpt-4o）でスライド内容を生成
4. python-pptxでPPTファイルを生成
5. ファイルを一時保存し、ダウンロードURLを返却

**出力**:
- file_url: ダウンロードURL
- slide_count: 生成されたスライド枚数
- generation_id: 生成履歴ID

#### 4.3 PPTテンプレート設計

**デフォルトテンプレート**:
- タイトルスライド: タイトル + サブタイトル + 日付
- 通常スライド: タイトル + 本文（箇条書き or 段落）
- 表スライド: タイトル + 表
- 図解スライド: タイトル + 画像プレースホルダー

**カスタマイズ**（Phase 2では実装しない、Phase 3で検討）:
- 教授が独自のテンプレートファイル（.pptx）をアップロード
- デザイン、フォント、色を維持

### 5. PPT生成履歴管理（Week 7）

#### 5.1 PPT生成履歴一覧画面

**レイアウト**:
```
[PPT生成履歴]
┌─────────────────────────────────────┐
│ 2025-11-24 | 競争戦略の基礎          │
│ ターゲット: 学部2年生 | 10枚          │
│ [再ダウンロード] [削除]              │
├─────────────────────────────────────┤
│ 2025-11-20 | イノベーションの本質    │
│ ターゲット: MBA | 15枚                │
│ [再ダウンロード] [削除]              │
└─────────────────────────────────────┘
```

---

## 📊 品質評価・KPI（Phase 2）

### 目標KPI（Phase 2終了時点）

| KPI | Phase 2目標値 | 測定方法 |
|-----|--------------|---------|
| **RAG検索精度** | Embeddingで関連度80%以上 | 教授による関連性評価（20件サンプル） |
| **コメント満足度** | 平均4.5以上（Phase 1: 4.0以上） | 満足度アンケート |
| **PPT生成満足度** | 平均4.0以上 | 満足度アンケート |
| **PPT生成速度** | 10枚のスライドを3分以内 | システムログから測定 |
| **音声認識精度** | 誤字率5%以下 | 教授による確認 |
| **ナレッジベース蓄積** | Phase 2終了時点で200件以上 | データベースから確認 |

### Phase 1からの改善目標

| 項目 | Phase 1 | Phase 2目標 | 改善率 |
|------|---------|------------|--------|
| コメント満足度 | 4.0 | 4.5 | +12.5% |
| RAG検索精度（関連性） | 60%程度（Jaccard） | 80%以上（Embedding） | +33% |

---

## 💰 コスト見積もり（Phase 2）

### 月間コスト（Phase 2運用時）

#### 使用想定
- レポートコメント生成: 週5件 × 4週 = 月20件
- 音声入力: 講義・講演を月10時間録音
- PPT資料生成: 月4回（週1回の講義資料）
- ナレッジベース: 500件程度まで蓄積

#### コスト内訳

| 項目 | 詳細 | 月額コスト |
|------|------|-----------|
| **OpenAI API** | | |
| - コメント生成 | gpt-4o-mini、20件 × $0.02 | ¥60 |
| - PPT生成 | gpt-4o、4回 × $0.50 | ¥300 |
| - Embedding | 音声10時間 ≈ 100K tokens × $0.02/1M | ¥3 |
| - Whisper API | 10時間 × $0.36/時間 | ¥550 |
| - タグ付け | gpt-4o-mini、50回 × $0.01 | ¥75 |
| **Vercel** | Hobby Plan（無料枠で十分） | ¥0 |
| **Supabase** | Free Tier（1GB、5万リクエスト） | ¥0 |
| **合計** | | **¥988/月** |

### Phase 1との比較
- **Phase 1**: ¥30/月
- **Phase 2**: ¥988/月
- **増加**: ¥958/月

### 年間コスト
- **Phase 2**: ¥988/月 × 12ヶ月 = **¥11,856/年**

---

## 📅 開発スケジュール（Phase 2: 8週間）

### 全体スケジュール

| 期間 | フェーズ | 主要タスク |
|------|---------|-----------|
| Week 1-2 | RAG基盤強化 | Embedding導入、pgvector設定、検索精度検証 |
| Week 3-4 | ナレッジベース管理UI | 一覧画面、テキスト追加、編集・削除機能 |
| Week 5-6 | ファイルアップロード機能 | ファイルアップロード、Whisper API統合、自動タグ付け |
| Week 7 | PPT資料生成機能 | PPT生成画面、バックエンドAPI、python-pptx統合 |
| Week 8 | テスト・改善・ドキュメント | 統合テスト、UAT、バグ修正、ドキュメント作成 |

### 詳細スケジュール

#### Week 1-2: RAG基盤強化（2週間）

**目標**: Embeddingベースの高精度検索を実装

**タスク**:
1. OpenAI Embeddings APIの統合
   - API認証設定
   - Embedding生成関数の実装
2. Supabase pgvector拡張の有効化
   - SQL実行: `CREATE EXTENSION vector;`
   - knowledge_baseテーブルにvectorカラム追加
3. 既存データのEmbedding化
   - 113件の参照例をバッチ処理でEmbedding化
   - データベースに保存
4. コサイン類似度検索の実装
   - pgvectorでの検索クエリ実装
   - 検索結果の上位N件取得（Nは調整可能、デフォルト3-5件）
5. 検索精度の検証
   - Jaccard類似度との比較
   - サンプルレポート20件で検証
   - 教授による関連性評価

**成果物**:
- Embedding検索機能
- 検証レポート

---

#### Week 3-4: ナレッジベース管理UI（2週間）

**目標**: 教授が思考を追加・管理できる画面を実装

**タスク**:
1. ナレッジベース管理画面の設計
   - ワイヤーフレーム作成
   - UI/UXレビュー
2. 一覧画面の実装
   - 全ナレッジベース表示
   - 検索・フィルタ機能（テキスト検索、タグフィルタ）
   - 並び替え機能（最新順、古い順、タグ別）
   - ページネーション（20件/ページ）
3. テキスト追加機能の実装
   - テキスト入力フォーム
   - コンテンツタイプ選択
   - LLMによる自動タグ付け（gpt-4o-mini）
   - タグの手動編集
   - Embedding化 + データベース保存
4. 編集・削除機能の実装
   - 既存ナレッジベースの編集
   - タグの変更
   - 削除確認ダイアログ
   - 物理削除実行
5. バックエンドAPI実装
   - GET /knowledge-base（一覧取得）
   - POST /knowledge-base（新規追加）
   - PUT /knowledge-base/{id}（編集）
   - DELETE /knowledge-base/{id}（削除）

**成果物**:
- ナレッジベース管理画面
- テキスト追加機能
- 編集・削除機能

---

#### Week 5-6: ファイルアップロード機能（2週間）

**目標**: 音声/テキストファイルをアップロードしてナレッジベースに追加できるようにする

**要件変更**: 音声録音機能（MediaRecorder API）→ ファイルアップロード機能に変更

**タスク**:
1. フロントエンドファイルアップロード機能
   - ドラッグ&ドロップUI実装
   - ファイル選択ボタン
   - アップロード進捗表示
   - ファイルタイプ検証（mp3, wav, m4a, txt）
   - ファイルサイズ制限（音声: 25MB、テキスト: 1MB）
2. Whisper API統合
   - OpenAI Whisper API認証設定
   - 音声ファイルアップロード
   - テキスト変換処理
3. テキストファイル処理
   - テキストファイル内容抽出
   - 文字コード自動検出（UTF-8, Shift-JIS等）
4. テキスト変換後の処理
   - 変換結果の表示
   - テキスト編集機能
   - LLMによる自動タグ付け
   - タグ確認・編集UI
5. ナレッジベースへの保存
   - Embedding化
   - データベース保存
   - ソース情報の記録（"audio" または "text"）
6. エラーハンドリング
   - 非対応ファイル形式のエラー表示
   - ファイルサイズ超過時のエラー表示
   - Whisper API失敗時のフォールバック
7. バックエンドAPI実装
   - POST /upload-file（ファイルアップロード）
   - ファイルタイプ判定ロジック

**成果物**:
- ファイルアップロード機能
- Whisper API統合
- ファイル→ナレッジベース追加フロー

---

#### Week 7: PPT資料生成機能（1週間）

**目標**: ターゲット・構成を指定してPPT生成

**タスク**:
1. PPT生成入力画面の実装
   - ターゲット選択UI
   - テーマ入力
   - 構成選択（チェックボックス）
   - 予想スライド枚数表示
2. バックエンドAPI実装（POST /generate-ppt）
   - テーマのEmbedding化
   - pgvectorで関連ナレッジベース検索（上位10-20件）
   - 各セクション毎にLLM（gpt-4o）呼び出し
   - スライド内容生成（タイトル + 本文）
3. python-pptx統合
   - デフォルトテンプレート作成
   - スライド生成ロジック実装
   - タイトルスライド、通常スライド、表スライドの実装
4. ファイル生成・ダウンロード
   - PPTファイル生成
   - 一時保存（/tmp/ または S3）
   - ダウンロードURL生成
   - フロントエンドでダウンロード
5. 生成履歴の保存
   - ppt_generationsテーブルに保存
   - 満足度アンケート実装
6. 生成進捗の表示
   - リアルタイム進捗表示（WebSocket or ポーリング）
   - 各スライド生成完了時にチェックマーク表示

**成果物**:
- PPT生成入力画面
- PPT生成API
- python-pptx統合
- ダウンロード機能

---

#### Week 8: テスト・改善・ドキュメント（1週間）

**目標**: Phase 2全体の品質向上と完成

**タスク**:
1. 統合テスト
   - 全機能の動作確認
   - ナレッジベース追加 → RAG検索 → コメント生成の一連のフロー
   - ナレッジベース追加 → PPT生成の一連のフロー
2. 教授によるUAT（ユーザー受け入れテスト）
   - ナレッジベースに10件追加（音声5件、テキスト5件）
   - PPT資料を3回生成
   - コメント生成10件で精度確認
   - 満足度アンケート記入
3. バグ修正
   - UATで発見されたバグの修正
   - エラーハンドリングの改善
4. パフォーマンス最適化
   - PPT生成速度の最適化（目標: 10枚を3分以内）
   - Embedding検索速度の確認
5. ドキュメント作成
   - Phase 2ユーザーマニュアル
   - Phase 2技術仕様書更新
   - Phase 2 API仕様書
6. デプロイ準備
   - 本番環境での動作確認
   - 環境変数設定確認
   - Supabase pgvector拡張の有効化確認

**成果物**:
- Phase 2完成版
- UATレポート
- ドキュメント一式

---

## ⚠️ リスク管理（Phase 2）

### 想定されるリスク

| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|---------|------|
| **Whisper API精度不足** | 中 | 低 | 誤字があっても教授が編集可能。誤字率5%以下を目標 |
| **PPT生成品質不足** | 高 | 中 | gpt-4oを使用、テンプレート改善、UAT期間で調整 |
| **PPT生成速度が遅い** | 中 | 中 | 並列処理の導入、スライド数の制限（上限20枚） |
| **pgvector性能不足** | 低 | 低 | データ量が数千件程度なら問題なし。Phase 3で専用ベクトルDB検討 |
| **音声録音が動作しない** | 中 | 低 | ブラウザ互換性テスト、ファイルアップロードのフォールバック |
| **コスト超過** | 低 | 低 | 月次監視、gpt-4oの使用量制限 |
| **開発期間超過** | 中 | 中 | Week 9のバッファ週を活用、スコープ調整 |

---

## ✅ Phase 2完了定義（Definition of Done）

Phase 2が完了したと判断する基準:

### 機能完成
- [ ] Embedding + pgvector によるRAG検索が動作する
- [ ] ナレッジベース管理画面（一覧、追加、編集、削除）が動作する
- [ ] テキスト入力でナレッジベースに追加できる
- [ ] 音声入力でナレッジベースに追加できる
- [ ] LLMによる自動タグ付け + 手動編集が動作する
- [ ] PPT資料生成（ターゲット + 構成 + テーマ指定）が動作する
- [ ] PPTファイルのダウンロードが動作する
- [ ] PPT生成履歴の保存・取得が動作する

### 品質達成
- [ ] RAG検索精度 80%以上（教授評価）
- [ ] コメント満足度 平均4.5以上
- [ ] PPT生成満足度 平均4.0以上
- [ ] PPT生成速度 10枚を3分以内
- [ ] 音声認識精度 誤字率5%以下
- [ ] ナレッジベース蓄積 200件以上

### ドキュメント完成
- [ ] Phase 2要件定義書（本ドキュメント）
- [ ] Phase 2開発手順書
- [ ] Phase 2ユーザーマニュアル
- [ ] Phase 2技術仕様書
- [ ] Phase 2 API仕様書
- [ ] UATレポート

### デプロイ完了
- [ ] 本番環境での動作確認
- [ ] pgvector拡張の有効化確認
- [ ] Whisper API動作確認
- [ ] PPT生成機能動作確認

### 教授承認
- [ ] 教授によるUAT完了承認
- [ ] Phase 3移行の判断

---

## 📞 次フェーズ（Phase 3）への展望

Phase 2完了後、以下のような拡張を検討できます：

### Phase 3候補機能
1. **学生向けチャットボット**（要件定義書v2で計画済み）
   - リアルタイムチャット機能
   - 教授のナレッジベースを活用して学生の質問に回答
2. **PPTデザインのカスタマイズ**
   - 教授独自のテンプレートアップロード
   - 画像・グラフの自動生成
3. **動画資料の対応**
   - 講義動画のアップロード
   - Whisperで文字起こし → ナレッジベース化
4. **複数ユーザー対応**
   - TA（ティーチングアシスタント）の追加
   - RBAC（ロールベースアクセス制御）
5. **高度な分析機能**
   - 学生のレポート傾向分析
   - 教授の思考パターン可視化

---

**以上**
