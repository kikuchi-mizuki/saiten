# UAT実施前チェックリスト

**目的**: UAT実施前にシステムが正常に動作することを確認する
**実施者**: 開発者、システム管理者
**実施タイミング**: UAT開始前（Week 12 Day 1）
**所要時間**: 約30分

---

## 📋 チェック項目

### 1. 環境変数の確認

#### フロントエンド（frontend/.env.local）

- [ ] `NEXT_PUBLIC_SUPABASE_URL`が設定されている
- [ ] `NEXT_PUBLIC_SUPABASE_ANON_KEY`が設定されている
- [ ] `NEXT_PUBLIC_API_BASE_URL`が設定されている
  - 開発環境: `http://localhost:8000`
  - 本番環境: 実際のAPIのURL

#### バックエンド（.env）

- [ ] `SUPABASE_URL`が設定されている
- [ ] `SUPABASE_ANON_KEY`が設定されている
- [ ] `SUPABASE_JWT_SECRET`が設定されている
- [ ] `ENCRYPTION_KEY`が設定されている（32文字以上）
- [ ] `OPENAI_API_KEY`が設定されている（有効なキー）
- [ ] `USE_LLM=1`が設定されている
- [ ] `LLM_MODEL=gpt-4o-mini`が設定されている
- [ ] `DISABLE_AUTH=0`が設定されている（本番モード）
  - ⚠️ **開発時のみ`DISABLE_AUTH=1`、UAT実施時は必ず`0`に設定**
- [ ] `ALLOWED_ORIGINS`が設定されている（本番環境のみ）
  - 例: `https://your-app.vercel.app`

### 2. ファイルの確認

#### プロンプトファイル

- [ ] `prompts/reflection.txt`が存在する
- [ ] `prompts/final.txt`が存在する
- [ ] 両ファイルの内容が適切である

#### 参照例データ

- [ ] `data/sample_comments.json`が存在する
- [ ] ファイルに50件程度の参照例が含まれている
- [ ] JSON形式が正しい（エラーがない）

#### ドキュメント

- [ ] `docs/uat_plan.md`（UAT計画書）が存在する
- [ ] `docs/baseline_measurement_guide.md`（ベースライン測定ガイド）が存在する
- [ ] `docs/uat_checklist.md`（UATチェックリスト）が存在する
- [ ] `docs/quick_user_guide.md`（簡易ユーザーマニュアル）が存在する
- [ ] `docs/environment_setup_guide.md`（環境変数設定ガイド）が存在する

### 3. データベースの確認

#### Supabaseダッシュボード

- [ ] Supabaseプロジェクトが作成されている
- [ ] データベースが正常に動作している

#### テーブルの確認

- [ ] `reports`テーブルが存在する
- [ ] `feedbacks`テーブルが存在する
- [ ] 各テーブルのカラムが正しい（`docs/database_schema.sql`と一致）

#### Row Level Security (RLS)

- [ ] `reports`テーブルでRLSが有効化されている
- [ ] `feedbacks`テーブルでRLSが有効化されている
- [ ] RLSポリシーが設定されている

### 4. フロントエンドの起動確認

#### ローカル環境

```bash
cd frontend
npm install
npm run dev
```

- [ ] `npm install`がエラーなく完了する
- [ ] `npm run dev`がエラーなく起動する
- [ ] ブラウザで`http://localhost:3000`にアクセスできる
- [ ] ログイン画面が表示される

#### 本番環境（Vercel）

- [ ] Vercelにデプロイされている
- [ ] 環境変数が正しく設定されている
- [ ] ブラウザでVercelのURLにアクセスできる
- [ ] ログイン画面が表示される

### 5. バックエンドの起動確認

#### ローカル環境

```bash
cd /path/to/saiten
pip install -r requirements.txt
uvicorn api.main:app --reload --host 0.0.0.0 --port 8000
```

- [ ] `pip install -r requirements.txt`がエラーなく完了する
- [ ] `uvicorn api.main:app --reload`がエラーなく起動する
- [ ] ブラウザで`http://localhost:8000/health`にアクセスすると`{"ok":true}`が表示される

#### 本番環境

- [ ] デプロイ先（Railway / Render / Heroku等）にデプロイされている
- [ ] 環境変数が正しく設定されている
- [ ] ブラウザで`https://your-api-domain.com/health`にアクセスすると`{"ok":true}`が表示される

### 6. 認証機能の確認

#### Google OAuth認証

- [ ] ログイン画面で「Googleでログイン」ボタンが表示される
- [ ] ボタンをクリックするとGoogle認証画面に遷移する
- [ ] Googleアカウントで認証できる
- [ ] 認証後、ダッシュボードにリダイレクトされる
- [ ] ヘッダーにメールアドレスが表示される

#### セッション管理

- [ ] ログイン状態がブラウザリロード後も維持される
- [ ] ログアウトボタンをクリックするとログアウトできる
- [ ] ログアウト後、ログイン画面に遷移する

### 7. コメント生成機能の確認

#### 基本的なコメント生成

- [ ] レポート本文を入力できる
- [ ] 「コメント生成」ボタンが表示される
- [ ] ボタンをクリックするとコメント生成が開始される
- [ ] 生成中は「生成中...」と表示される
- [ ] 30秒以内に生成が完了する

#### Rubric採点結果

- [ ] Rubric採点結果が表示される（5項目）
- [ ] 各項目に1-5点のスコアが表示される
- [ ] 各項目に採点理由が表示される
- [ ] 合計スコア（/25点）が表示される

#### 要約生成

- [ ] 要約が表示される
- [ ] 要約がレポートの要点を捉えている
- [ ] 要約の文字数が適切である（100〜300文字程度）

#### コメント生成

- [ ] コメントが表示される
- [ ] コメントが自然な日本語である
- [ ] コメントが300〜600文字程度である
- [ ] コメントが編集可能である

### 8. PII検出・マスキング機能の確認

テスト用のレポート本文（個人情報を含む）:

```
私は山田太郎（学籍番号: 12345678）です。
連絡先: yamada@example.com、電話番号: 090-1234-5678。
経営戦略論の講義で学んだ内容を振り返ります。
```

- [ ] レポート本文に上記のテキストを入力
- [ ] コメント生成を実行
- [ ] 生成されたコメント・要約に個人情報が含まれていない
- [ ] 個人情報がマスキングされている（[氏名]、[学籍番号]等）

### 9. 履歴機能の確認

#### 履歴保存

- [ ] コメント生成後、データがデータベースに保存される
- [ ] 「履歴」ボタンをクリックすると履歴一覧が表示される
- [ ] 保存したコメントが履歴一覧に表示される

#### 履歴詳細

- [ ] 履歴をクリックすると詳細画面が表示される
- [ ] レポート本文、Rubric、要約、コメントが表示される

#### 履歴削除

- [ ] 「削除」ボタンをクリックすると確認ダイアログが表示される
- [ ] 削除後、履歴一覧から消えている

### 10. エクスポート機能の確認

- [ ] 履歴一覧画面に「エクスポート」ボタンが表示される
- [ ] JSON形式でエクスポートできる
- [ ] CSV形式でエクスポートできる
- [ ] エクスポートしたファイルが正しい形式である

### 11. 品質評価機能の確認

#### 手直し時間測定

- [ ] コメント生成完了時に生成時刻が記録される
- [ ] 「保存」ボタンをクリックすると手直し時間が計算される

#### 満足度アンケート

- [ ] 「保存」ボタンをクリックすると満足度アンケートが表示される
- [ ] 満足度を1-5点で選択できる
- [ ] フィードバックテキストを入力できる
- [ ] 「送信」ボタンをクリックすると保存される

### 12. 統計表示機能の確認

- [ ] ダッシュボードに統計情報セクションが表示される
- [ ] 「表示」ボタンをクリックすると統計データが展開される
- [ ] 総コメント生成数が表示される
- [ ] 平均Rubric点数が表示される
- [ ] 平均手直し時間が表示される
- [ ] 平均満足度が表示される

### 13. エラー処理の確認

#### 入力エラー

- [ ] レポート本文が空の場合、エラーメッセージが表示される
- [ ] エラーメッセージが分かりやすい

#### OpenAI APIエラー（テスト方法: APIキーを一時的に無効化）

- [ ] エラーメッセージが表示される
- [ ] エラー後も操作を続けられる

### 14. UI/UXの確認

#### レイアウト

- [ ] 2カラムレイアウト（7:5比率）が表示される
- [ ] Academic Minimal UIデザインが適用されている

#### 操作性

- [ ] ボタンのホバー効果が適切である
- [ ] タブの切り替えがスムーズである
- [ ] フォーム入力が直感的である

---

## ✅ 確認完了後のアクション

### すべてのチェック項目がOKの場合

- [ ] UAT計画書（`docs/uat_plan.md`）を最終確認
- [ ] ベースライン測定ガイド（`docs/baseline_measurement_guide.md`）を最終確認
- [ ] 簡易ユーザーマニュアル（`docs/quick_user_guide.md`）を教授に共有
- [ ] UAT実施者（教授）に連絡し、UAT開始日時を調整

### 問題が発見された場合

- [ ] 問題をログに記録（`docs/known_issues_week12.md`に追加）
- [ ] 重大な問題は修正してから再度確認
- [ ] 軽微な問題はUAT期間中に監視

---

## 📝 確認結果の記録

**確認実施日**: 20XX年XX月XX日
**確認実施者**: ___________
**確認環境**: [ ] ローカル環境  [ ] 本番環境

### チェック結果サマリー

- 総チェック項目数: _____ 項目
- OK項目数: _____ 項目
- NG項目数: _____ 項目
- 成功率: _____ %

### 発見された問題

| No. | 問題内容 | 重要度 | 対応状況 |
|-----|---------|--------|---------|
| 1 | | [ ] High [ ] Medium [ ] Low | |
| 2 | | [ ] High [ ] Medium [ ] Low | |
| 3 | | [ ] High [ ] Medium [ ] Low | |

### UAT実施判定

- [ ] **UAT実施可能** - すべての項目が正常に動作している
- [ ] **UAT実施保留** - 重大な問題が発見された（修正後に再確認）

**署名**: ___________

---

**以上**
