# サンプルコメント追加ガイド

教授コメントの参照例（RAG用）を追加する際の手順とテンプレートです。

---

## 📊 スプレッドシートから一括読み込み

CSV/Excelファイルから一括でコメントを読み込めます。

### 1. スプレッドシートを用意

以下の列を含むCSVまたはExcelファイルを作成してください：

| 列名 | 説明 | 必須 | 例 |
| --- | --- | --- | --- |
| `id` | 一意の識別子 | ✅ | `ex4`, `ref_2025_01` |
| `type` | 種別 | ❌ | `reflection`（デフォルト）または `final` |
| `text` | コメント本文 | ✅ | `○ 学生の主張...\n○ 教授の洞察...\n○ 次の一歩...` |
| `tags` | タグ（カンマ区切り） | ❌ | `仮説検証,KPI,顧客価値` |
| `source` | 出典 | ❌ | `professor_examples`（デフォルト） |

**注意**: `text`列で改行は`\n`で記述してください。

### 2. スクリプトを実行

```bash
# CSVの場合
python scripts/import_comments.py data/comments.csv

# Excelの場合
python scripts/import_comments.py data/comments.xlsx

# 既存データに追加する場合（デフォルト）
python scripts/import_comments.py data/comments.csv --merge

# 既存データを置き換える場合
python scripts/import_comments.py data/comments.csv --replace
```

### 3. 依存パッケージのインストール

初回のみ、以下のパッケージをインストールしてください：

```bash
pip install pandas openpyxl
```

### 4. Google Sheetsからエクスポート

Google Sheetsを使用している場合：

1. Google Sheetsで「ファイル」→「ダウンロード」→「CSV（.csv）」
2. ダウンロードしたCSVファイルを`data/`ディレクトリに配置
3. 上記スクリプトを実行

---

## 📝 手動追加方法

### 1. ファイルを開く
`data/sample_comments.json` をエディタで開きます。

### 2. テンプレートをコピー

```json
{
  "id": "ex3",
  "type": "reflection",
  "text": "○ 学生の主張の要点（要約）\n○ 教授の洞察（あり方×実務）\n○ 次の一歩（具体的アクション）",
  "tags": ["仮説検証", "KPI", "顧客価値"],
  "source": "professor_examples"
}
```

### 3. 編集ポイント

| 項目 | 内容 | 例 |
| --- | --- | --- |
| `id` | 一意の識別子 | `ex4`, `ref_2025_01`, `case_hypothesis` など |
| `type` | 種別 | `reflection`（振り返り）または `final`（最終） |
| `text` | コメント本文 | 3段「○」構成、200〜350文字目安 |
| `tags` | 論点タグ | 2〜4語で論点を表す（配列） |
| `source` | 出典 | `professor_examples`（固定でOK） |

---

## ✏️ 品質を上げるコツ

### ✅ 良いコメントの特徴

- **文末のバリエーション**
  - 「〜が見えます」「〜をおすすめします」「〜を意識してみましょう」
  - 「〜を検討してみてください」「〜が期待できます」

- **「あり方」×「次の一歩」の両立**
  - 「あり方」は「哲学」「価値観」「意思決定の軸」
  - 「次の一歩」は「仮説検証」「KPI設定」「顧客観察」など具体的アクション

- **実務名詞の使用**
  - KPI、撤退基準、仮説検証、顧客価値、価格受容性、意思決定、観察など

- **断定を避ける**
  - ❌ 「〜すべき」「〜しなければならない」
  - ✅ 「〜をおすすめします」「〜を意識してみましょう」

### 📏 文字数・構成

- **総文字数**: 200〜350文字（目安）
- **構成**: 必ず3段「○」構成
  - 1段: 学生の主張要約（約80〜110文字）
  - 2段: 教授の洞察（約80〜140文字）
  - 3段: 次の一歩（約80〜110文字）

### 🏷️ タグ付けの例

| タグ例 | 該当論点 |
| --- | --- |
| `仮説検証` | 仮説→検証のループ、撤退基準 |
| `KPI` | KPI設定、指標設計、評価基準 |
| `顧客価値` | 顧客視点、価値仮説、行動観察 |
| `価格` | 価格受容性、価格戦略、A/B検証 |
| `組織` | 意思決定、責任境界、組織設計 |
| `撤退基準` | 判断基準、撤退タイミング |
| `B2B` / `B2C` | ビジネスモデル種別 |

---

## 📦 件数目安

- **初期**: 10〜30件
- **理想**: 50〜100件（講義テーマが均等に分布）

### テーマ別の推奨件数

| テーマ | 推奨件数 |
| --- | --- |
| 仮説検証・撤退基準 | 5〜10件 |
| KPI・指標設計 | 5〜10件 |
| 顧客価値・行動観察 | 5〜10件 |
| 価格戦略 | 3〜5件 |
| 組織設計・意思決定 | 3〜5件 |

---

## 🔄 更新後の動作確認

1. `sample_comments.json` を保存
2. APIを再起動（自動リロードなら不要）
3. UIで生成を実行
4. `used_refs` に追加したコメントが反映されているか確認

---

## ⚠️ 注意事項

- **カンマ忘れに注意**: 配列の最後の要素にもカンマを付けない
- **改行**: `\n` ではなく実際の改行でOK
- **文字エンコーディング**: UTF-8で保存
- **JSON構文エラー**: エディタでバリデーション確認（VS Codeなど）

---

## 📚 参考

- プロンプト: `prompts/reflection.txt`
- API実装: `api/main.py` の `retrieve_refs()` 関数
